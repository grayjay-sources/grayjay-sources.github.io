{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "array",
  "items": {
    "$ref": "#/definitions/Source"
  },
  "definitions": {
    "Source": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "author": {
          "type": "string"
        },
        "authorUrl": {
          "type": "string"
        },
        "maxDownloadParallelism": {
          "type": "integer"
        },
        "changelogUrl": {
          "type": "string"
        },
        "sourceUrl": {
          "type": "string",
          "pattern": "^(\\./|\\.\\./|https?://|/|[a-zA-Z]:\\\\).*\\.(json)$|^$|^(https?://[^/]+/.+)$",
          "description": "URL to the source configuration file. Must be a relative path (./config.json), absolute path (/config.json), full URL (https://example.com/config.json), or base URL (https://example.com/), or empty"
        },
        "repositoryUrl": {
          "type": "string"
        },
        "scriptUrl": {
          "type": "string",
          "pattern": "^(\\./|\\.\\./|https?://|/|[a-zA-Z]:\\\\).*\\.(js|ts|mjs)$|^$",
          "description": "Path to the script file. Must be a relative path (./script.js), absolute path (/script.js), or full URL (https://example.com/script.js), or empty"
        },
        "version": {
          "type": "integer"
        },
        "iconUrl": {
          "type": "string",
          "pattern": "^(\\./|\\.\\./|https?://|/|[a-zA-Z]:\\\\).*\\.(png|jpg|jpeg|gif|svg|ico|webp)(\\?.*)?$|^$|^(https?://[^/]+/.+)$",
          "description": "Path to the icon file. Must be a relative path (./icon.png), absolute path (/icon.png), full URL (https://example.com/icon.png), URL with query params, any valid URL, or empty"
        },
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "packages": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Package"
          }
        },
        "allowEval": {
          "type": "boolean"
        },
        "allowUrls": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "scriptSignature": {
          "type": "string"
        },
        "scriptPublicKey": {
          "type": "string"
        },
        "platformUrl": {
          "type": "string"
        },
        "authentication": {
          "$ref": "#/definitions/Authentication"
        },
        "settings": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Setting"
          }
        },
        "supportedClaimTypes": {
          "type": "array",
          "items": {
            "type": "integer"
          }
        },
        "constants": {
          "$ref": "#/definitions/Constants"
        },
        "allowAllHttpHeaderAccess": {
          "type": "boolean"
        },
        "websiteUrl": {
          "type": "string"
        },
        "changelog": {
          "type": "object",
          "patternProperties": {
            "^[0-9]+$": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "additionalProperties": false
        },
        "subscriptionRateLimit": {
          "type": "integer"
        },
        "captcha": {
          "$ref": "#/definitions/CAPTCHA"
        },
        "primaryClaimFieldType": {
          "type": "integer"
        },
        "_customButtons": {
          "type": "array",
          "description": "Custom action buttons shown on the source card",
          "items": {
            "$ref": "#/definitions/CustomButton"
          }
        },
        "_generatorUrl": {
          "type": "string",
          "description": "URL to a web-based generator for creating custom plugin instances. If present, shows a 'Generate' button instead of 'Install'"
        },
        "_nsfw": {
          "type": "boolean",
          "description": "Mark source as NSFW content. Will be filtered by default unless user opts in"
        },
        "_tags": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "_feeds": {
          "$ref": "#/definitions/Feeds"
        },
        "_installUrl": {
          "type": "string"
        }
      },
      "required": [],
      "title": "Source"
    },
    "CustomButton": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "text": {
          "type": "string"
        },
        "url": {
          "type": "string"
        },
        "classes": {
          "type": "string"
        }
      },
      "required": [],
      "title": "CustomButton"
    },
    "Feeds": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "commits": {
          "type": "string"
        },
        "releases": {
          "type": "string"
        }
      },
      "required": [],
      "title": "Feeds"
    },
    "Authentication": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "loginUrl": {
          "type": "string"
        },
        "userAgent": {
          "type": "string"
        },
        "cookiesToFind": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "headersToFind": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "cookiesExclOthers": {
          "type": "boolean"
        },
        "completionUrl": {
          "type": "string"
        },
        "loginButton": {
          "type": "string"
        },
        "domainHeadersToFind": {
          "$ref": "#/definitions/DomainHeadersToFind"
        },
        "loginWarning": {
          "type": "string"
        }
      },
      "required": [],
      "title": "Authentication"
    },
    "DomainHeadersToFind": {
      "type": "object",
      "additionalProperties": true,
      "properties": {},
      "required": [],
      "title": "DomainHeadersToFind"
    },
    "CAPTCHA": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "userAgent": {
          "type": "string"
        },
        "captchaUrl": {
          "type": "null"
        },
        "cookiesToFind": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [],
      "title": "CAPTCHA"
    },
    "Constants": {
      "type": "object",
      "additionalProperties": {
        "type": "string"
      },
      "properties": {},
      "required": [],
      "title": "Constants"
    },
    "Setting": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "variable": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "type": {
          "$ref": "#/definitions/Type"
        },
        "default": {
          "$ref": "#/definitions/Default"
        },
        "options": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "warningDialog": {
          "type": "string"
        },
        "dependency": {
          "type": "string"
        }
      },
      "required": [],
      "title": "Setting"
    },
    "Default": {
      "type": "string",
      "title": "Default Value"
    },
    "Package": {
      "type": "string",
      "enum": ["Http", "DOMParser", "Utilities"],
      "title": "Package"
    },
    "Type": {
      "type": "string",
      "enum": ["Dropdown", "Header", "Boolean"],
      "title": "Type"
    },
    "BoolOrString": {
      "anyOf": [
        {
          "type": "boolean"
        },
        {
          "$ref": "#/definitions/BoolString"
        }
      ]
    },
    "BoolString": {
      "type": "string",
      "pattern": "^(TRUE|True|true|FALSE|False|false|YES|Yes|yes|NO|No|no|ON|On|on|OFF|Off|off|0|1|ENABLED|Enabled|enabled|DISABLED|Disabled|disabled|ENABLE|Enable|enable|DISABLE|Disable|disable)$"
    },
    "NullOrString": {
      "anyOf": [
        {
          "type": "null"
        },
        {
          "type": "string"
        }
      ]
    }
  }
}
